<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//CN" "http://www.w3.org//TR/xhtml//DTD//xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="utf-8">
<head>
    <include file="Public:meta" title="创建调查 | 维新调研 · 倾听，发现"/>
    <link rel="stylesheet" href="__JMVC__/style/survey.create.css" type="text/css" />
    <script type="text/javascript" src="__JMVC__/steal/steal.js?script/survey.create.js"></script>
</head>
<body>
    <div id="Header" data-verify="1">
        <include file="Public:topBar" page="{$page}" nav-type="sub" nav-cur="survey" need-login="1"/>
    </div>
    <div id="Main" data-sv-code="{$survey_code}" data-sv-type="{$sv_type}" data-sv-type-sub="{$sv_type_sub}">
        <div id="mainSider">
                <div id="coinsBox">
                    <div class="remain-coins">
                        <div class="coins-value">0</div>
                        <div class="coins-desc">可用金币</div>
                    </div>
                    <div class="used-coins">
                        <div class="coins-value">0</div>
                        <div class="coins-desc">所需金币</div>
                    </div>
                </div>
                <div id="stepBox">
                    <ul>
                        <li class="step1" data-section="surveyContent">调查内容 >></li>
                        <li class="step2" data-section="surveySetting">调查属性 >></li>
                        <li class="step3" data-section="surveyRecommend">调查推荐 >></li>
                    </ul>
                </div>
                <div id="syncBox" data-state="-1">
                    <div class="sync-auto">
                        <div class="last">
                            <div class="time"></div>
                            <div class="desc">已保存最新草稿</div>
                        </div>
                        <div class="next">
                            <div class="time"></div>
                            <div class="desc">将自动保存草稿</div>
                        </div>
                        <div class="doing">
                            <i class="icon-refresh icon-spin"></i>
                            <div class="desc">保存草稿中.....</div>
                        </div>
                    </div>
                    <div class="sync-manu">立即保存为草稿</div>
                </div>
                <div id="siderFoot">
                    <div id="helpBox">
                        <div>如何创建调查</div>
                        <div>金币使用规则</div>
                        <div>其他常见问题</div>
                    </div>
            </div>  
        </div>
        <div id="mainBody">
            <div id="surveyBox">
                <div id="surveyContent" class="sv-elem sv-content" data-step="step1">
                    <div class="svc-header"><strong>调查内容</strong></div>
                    <div class="svc-body vkform">
                        <div id="surveyTitle" class="cs-item">
                            <div class="cs-label">调查标题</div>
                            <div class="cs-content base-info vf-elem" data-name="survey_name" data-elem-type="required">
                                <input type="text" name="survey_name" class="vk-input green large block" placeholder="请输入调查标题">
                            </div>
                        </div>
                        <div id="surveyTag" class="cs-item">
                            <div class="cs-label">调查标签</div>
                            <div class="cs-content base-info">
                                <ul class="survey-tag" name="survey_tag"></ul>
                            </div>
                        </div>
                        <div id="surveyDesc" class="cs-item" data-title="调查说明">
                            <div class="cs-label">调查说明</div>
                            <div class="cs-content base-info vf-elem" data-name="survey_desc">
                                <div class="vk-input green large block" name="survey_desc" contenteditable="true"></div>
                            </div>
                        </div>
                        <div id="surveyItem" class="cs-item" data-title="调查题目">
                            <div class="cs-label">调查题目</div>
                            <div class="cs-content">
                                <div id="itemBody"></div>
                                <div id="itemButton">
                                    <div class="add-item">
                                        <button class="vkbutton vbtn-default radio" data-type="radio">新增单选题</button>
                                        <button class="vkbutton vbtn-default checkbox" data-type="checkbox">新增多选题</button>
                                        <button class="vkbutton vbtn-default textarea" data-type="textarea">新增主观题</button>
                                        <button class="vkbutton vbtn-default bank" data-type="bank" style="display:none">从题库选择题目</button>
                                    </div>
                                    <div class="preview-item">
                                        <button class="vkbutton vbtn-default" data-type="textarea">预览调查题目</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="surveySetting" class="sv-elem sv-content" data-step="step2">
                    <div class="svc-header"><strong>调查属性</strong></div>
                    <div class="svc-body">
                        <div class="cs-item survey-class" data-sv-type="0" data-sv-type-sub="0" data-sv-trade="0">
                            <div class="cs-label">调查分类</div>
                            <div class="cs-content">
                                <div class="survey-type" data-info="survey_type">
                                    <div class="se-body dropdown">
                                        <a class="dropdown-toggle" data-toggle="dropdown">点击选择<i class='icon-angle-down'></i></a>
                                        <div class="dropdown-menu pull-right" role="menu" aria-labelledby="dLabel">
                                            <volist name="survey_type" id="st">
                                            <a class="sv-type" data-code="{$st.survey_type_code}">{$st.survey_type_name}</a>
                                            </volist>
                                        </div>
                                    </div>
                                    <div class="se-desc">调查归属大类</div>
                                </div>
                                <div class="survey-type-sub" data-info="survey_type_sub">
                                    <div class="se-body dropdown">
                                        <a class="dropdown-toggle" data-toggle="dropdown">点击选择<i class='icon-angle-down'></i></a>
                                        <div class="dropdown-menu pull-right" role="menu" aria-labelledby="dLabel">
                                            <a class="sts-tpl"></a>
                                        </div>
                                    </div>
                                    <div class="se-desc">调查归属小类</div>
                                </div>
                                <div class="survey-trade" data-info="survey_trade">
                                    <div class="se-body dropdown">
                                        <a class="dropdown-toggle" data-toggle="dropdown">点击选择<i class='icon-angle-down'></i></a>
                                        <div class="dropdown-menu pull-right sv-trade" role="menu" aria-labelledby="dLabel">
                                            <volist name="survey_trade" id="st">
                                            <a class="sv-trade" data-code="{$st.survey_trade_code}">{$st.survey_trade_name}</a>
                                            </volist>
                                        </div>
                                    </div>
                                    <div class="se-desc">调查所属行业</div>
                                </div>
                            </div>
                        </div>
                        <div class="cs-item survey-range">
                            <div class="cs-label">参与用户范围</div>
                            <div class="cs-content base-info vf-elem" data-vf-name="target_range">
                                <select type="select" name="target_range">
                                    <option value="999">允许所有用户参与</option>
                                    <volist name="level" id="lvl">
                                    <option value="{$lvl.user_level_value}">允许{$lvl.user_level_desc}等级以上用户参与</option>
                                    </volist>
                                </select>
                            </div>
                        </div>
                        <div class="cs-item survey-end" data-sv-end="0" data-sv-end-value="0">
                            <div class="cs-label">活动周期设置</div>
                            <div class="cs-content">
                                <div class="end-type">
                                    <div class="se-body dropdown">
                                        <a class="dropdown-toggle" data-toggle="dropdown">点击选择<i class='icon-angle-down'></i></a>
                                        <div class="dropdown-menu pull-right" role="menu" aria-labelledby="dLabel">
                                            <a class="sv-et" data-code="1">参与人数</a>
                                            <a class="sv-et" data-code="2">开展时长</a>
                                        </div>
                                    </div>
                                    <div class="se-desc">活动结束方式</div>
                                </div>
                                <div class="end-value" data-sv-end="0" data-title="活动">
                                    <input class="ev-elem end-val-1" data-val="0" onkeyup="value=value.replace(/[^\d]/g,'')">
                                    <div class="ev-elem se-body dropdown end-val-2" data-val="0">
                                        <a class="dropdown-toggle" data-toggle="dropdown">点击选择<i class='icon-angle-down'></i></a>
                                        <div class="dropdown-menu pull-right" role="menu" aria-labelledby="dLabel">
                                            <a class="ev-day" data-code="5">5天</a><a class="ev-day" data-code="10">10天</a>
                                            <a class="ev-day" data-code="15">15天</a><a class="ev-day" data-code="20">20天</a>
                                            <a class="ev-day" data-code="25">25天</a><a class="ev-day" data-code="30">30天</a>
                                        </div>
                                    </div>
                                    <div class="se-desc">活动开展时长</div>
                                </div>
                                <button class="end-desc" style="display:none"></button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="surveyRecommend" class="sv-elem sv-content" data-step="step3" data-recomm="0">
                    <div class="svc-header">
                        <strong>调查推荐</strong>
                    </div>
                    <div class="svc-body">
                        <div class="recomm-main">
                            <div class="recomm-elem self" data-rec="1">
                                <div class="re-before">
                                    <div class="re-title">自定义推荐调查</div>
                                    <div class="re-desc">
                                        <div class="re-value">30</div>
                                        <div class="re-span">需要金币</div>
                                    </div>
                                </div>
                                <div class="re-focus dropdown-toggle" data-toggle="dropdown">
                                    <div class="dt-init">
                                        <div class="re-title">自定义推荐调查</div>
                                        <div class="re-desc">设置自己的推荐规则精确定位目标人群</div>
                                    </div>
                                </div>
                                <div class="re-after">
                                    <div class="rea-desc">自定义推荐调查</div>
                                    <div class="rea-icon"><i class="icon-ok"></i></div>
                                </div>
                            </div>
                            <div class="recomm-elem auto" data-rec="2">
                                <div class="re-before">
                                    <div class="re-title">系统推荐调查</div>
                                    <div class="re-desc">
                                        <div class="re-value">30</div>
                                        <div class="re-span">需要金币</div>
                                    </div>
                                </div>
                                <div class="re-focus">
                                    <div class="re-title">系统推荐调查</div>
                                    <div class="re-desc">由系统统一按照最有效率的方式推荐调查</div>
                                </div>
                                <div class="re-after">
                                    <div class="rea-desc">系统推荐调查</div>
                                    <div class="rea-icon"><i class="icon-ok"></i></div>
                                </div>
                            </div>
                            <div class="recomm-elem none" data-rec="0">
                                <div class="re-before">
                                    <div class="re-title">不推荐调查</div>
                                    <div class="re-desc">
                                        <div class="re-value">0</div>
                                        <div class="re-span">需要金币</div>
                                    </div>
                                </div>
                                <div class="re-focus">
                                    <div class="re-title">不推荐调查</div>
                                    <div class="re-desc">不会主动向用户推荐调查但可以被搜索到</div>
                                </div>
                                <div class="re-after">
                                    <div class="rea-desc">不推荐调查</div>
                                    <div class="rea-icon"><i class="icon-ok"></i></div>
                                </div>
                            </div>
                        </div>
                        <div class="recomm-self">
                            <div class="res-sub">
                                <div class="recomm-elem self" data-rec="1">推荐规则设置</div>
                                <div class="recomm-elem auto" data-rec="2">
                                    <div class="re-title">系统推荐调查</div>
                                </div>
                                <div class="recomm-elem none" data-rec="0">
                                    <div class="re-title">不推荐调查</div>
                                </div>
                            </div>
                            <div class="res-main">
                                <div class="res-wrap"></div>
                                <div class="res-nav">
                                    <div class="rule-nav tpl">
                                        <div class="rule-seq">规则1</div>
                                        <div class="rule-num">9999</div>
                                    </div>
                                    <div class="rule-nav active">
                                        <div class="rule-seq">规则2</div>
                                        <div class="rule-num">383</div>
                                    </div>
                                    <div class="rule-add"><i class="icon-plus"></i></div>
                                </div>
                                <div class="res-body">
                                    <div class="rule-setting">
                                        <div class="rst-body">
                                        </div>
                                        <div class="rst-sider">
                                            <div class="rst-menu">用户性别</div>
                                            <div class="rst-menu active">用户年龄</div>
                                            <div class="rst-menu">用户职业</div>
                                            <div class="rst-menu">用户学历</div>
                                            <div class="rst-menu">用户地域</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="res-footer">
                                    <div class="recomm-num">可推荐总用户数<span>12345</span></div>
                                    <div class="recomm-confirm">
                                        <button class="vkbutton vbtn-border vbtn-warning large">全部规则设置完成</button>
                                    </div>
                                    <div class="recomm-cancel">
                                        <button class="vkbutton vbtn-border vbtn-warning large">取消设置</button>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div id="recommBox" data-recomm-type="-1" style="display:none">
                            <div id="recommChoose">
                                <div class="choose-elem recomm-self" data-recomm="2">
                                    <div class="type-desc-before">
                                        <div class="choose-desc">
                                            <div class="choose-title">自定义推荐</div>
                                            <div class="choose-detail">设置适合自己的详细推荐规则，精准定位目标人群</div>
                                        </div>
                                        <div class="choose-coins">
                                            <div class="coins-desc">需消耗金币</div>
                                            <div class="coins-value">30</div>
                                        </div>
                                    </div>
                                    <div class="type-desc-after">自定义推荐规则已设定，再点此可重新设定</div>
                                </div>
                                <div class="choose-elem recomm-auto" data-recomm="1">
                                    <div class="type-desc-before">
                                        <div class="choose-desc">
                                            <div class="choose-title">系统自动推荐</div>
                                            <div class="choose-detail">由系统按照统一的最有效率的方法推荐您的调查</div>
                                        </div>
                                        <div class="choose-coins">
                                            <div class="coins-desc">需消耗金币</div>
                                            <div class="coins-value">30</div>
                                        </div>
                                    </div>
                                    <div class="type-desc-after">由系统按照最优规则推荐本次调查活动</div>
                                </div>
                                <div class="choose-elem recomm-none" data-recomm="0">
                                    <div class="type-desc-before">
                                        <div class="choose-desc">
                                            <div class="choose-title">不推荐调查</div>
                                            <div class="choose-detail">本次调查不会主动推荐给参与者，但可以被用户搜索到</div>
                                        </div>
                                        <div class="choose-coins">
                                            <div class="coins-desc">需消耗金币</div>
                                            <div class="coins-value">0</div>
                                        </div>
                                    </div>
                                    <div class="type-desc-after">不推荐本次调查活动</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="surveyButton">
                    <button type="button" class="vkbutton vbtn-success vbtn-pure btn-block" title="发布调查">发布调查</button>
                </div>
                <div id="footerBox">维新调研 · 技术支持</div>
            </div>
        </div>
        <div id="successBox" style="display:none">
            <label class="suc-label"><i class="icon-thumbs-up"></i>本次调查创建成功，我现在想：</label>
            <div class="suc-next">
                <a class="next-act" href="{:U('survey/create')}">>>   继续创建调查</a>
                <a class="next-act sv-analy" href="{:U('survey/analyse')}">>>   查看本次调查</a>
                <a class="next-act" href="{:U('user/index')}">>>   管理我的调查</a>
                <a class="next-act sv-type" href="{:U('survey/type')}">>>   查看同类型调查</a>
                <a class="next-act sv-trade" href="{:U('survey/trade')}" sytle="dispalay:none">>>   查看同行业调查</a>
                <a class="next-act" href="{:U('survey/index')}">>>   前往调查中心</a>
            </div>
        </div>

        <!----------创建调查成功弹出框---------->
        <div id="recommendRule" class="modal hide fade" style="display:none">
            <div class="modal-header">
                <div class="name">请设置你的推荐规则</div>
                <button class="vkbutton vbtn-border vbtn-default rule-cancel">取消/关闭</button>
            </div>
            <div class="modal-body">
                <div id="recommSetting" class="recomm-rule-body tab-content vk-form">
                    <div id="explain" class="tab-pane rule-item active">规则说明</div>
                    <div id="sex" class="tab-pane vf-elem rule-item" data-rule-key="user_sex" data-rule-logic="in">
                        <label class="vf-elem-option"><input type="checkbox" value="1">男性</label>
                        <label class="vf-elem-option"><input type="checkbox" value="2">女性</label>
                    </div>
                    <div id="age" class="tab-pane vf-elem rule-item" data-rule-key="user_age" data-rule-logic="between">
                        <div class="minage">
                            <label class="control-label">用户最小年龄范围</label>
                            <input type="text" class="min" placeholder="最小年龄">
                        </div>
                        <div class="maxage">
                            <label class="control-label">用户最大年龄范围</label>
                            <input type="text" class="max" placeholder="最大年龄">
                        </div>
                    </div>
                    <div id="area" class="tab-pane rule-item vf-elem" data-rule-key="area_province" data-rule-logic="in">
                        <volist name="province" id="pv">
                        <label class="vf-elem-option inline">
                            <input type="checkbox" name="area_province" value="{$pv.area_province_code}">{$pv.area_province_name}
                        </label>
                        </volist>
                    </div>
                    <div id="edu" class="tab-pane vf-elem rule-item" data-rule-key="user_edu" data-rule-logic="in">
                        <volist name="edu" id="edu">
                        <label class="vf-elem-option inline">
                            <input type="checkbox" name="user_edu" value="{$edu.user_edu_code}">{$edu.user_edu_desc}
                        </label>
                        </volist>
                    </div>
                    <div id="career" class="tab-pane vf-elem rule-item" data-rule-key="user_career" data-rule-logic="in">
                        <volist name="career" id="ca">
                        <label class="vf-elem-option large inline">
                            <input type="checkbox" name="user_career" value="{$ca.user_career_code}">{$ca.user_career_desc}
                        </label>
                        </volist>
                    </div>
                    <div id="income" class="tab-pane rule-item" data-rule-key="user_income" data-rule-logic="in">
                    </div>
                </div>
                <div class="recomm-rule-side">
                    <div class="recomm-rule-option">
                        <ul class="nav nav-pills nav-stacked">
                            <li class="sex" data-rule-key="user_sex">
                                <a href="#sex" data-toggle="tab">
                                    <i class="icon-ok"></i><i class="icon-remove" title="清除此项规则"></i>用户性别
                                </a>
                            </li>
                            <li class="age" data-rule-key="user_age">
                                <a href="#age" data-toggle="tab">
                                    <i class="icon-ok"></i><i class="icon-remove" title="清除此项规则"></i>用户年龄
                                </a>
                            </li>
                            <li class="area" data-rule-key="area_province">
                                <a href="#area" data-toggle="tab">
                                    <i class="icon-ok"></i><i class="icon-remove" title="清除此项规则"></i>用户地域
                                </a>
                            </li>
                            <li class="edu" data-rule-key="user_edu">
                                <a href="#edu" data-toggle="tab">
                                    <i class="icon-ok"></i><i class="icon-remove" title="清除此项规则"></i>用户学历
                                </a>
                            </li>
                            <li class="career" data-rule-key="user_career">
                                <a href="#career" data-toggle="tab">
                                    <i class="icon-ok"></i><i class="icon-remove" title="清除此项规则"></i>用户职业
                                </a>
                            </li>
                            <li class="income" data-rule-key="user_income">
                                <a href="#income" data-toggle="tab">
                                    <i class="icon-ok"></i><i class="icon-remove" title="清除此项规则"></i>用户收入
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="btn btn-link recomm-rule-help" href="#explain" data-toggle="tab">如何设置规则？</div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="recomm-rule-stats">
                    <div class="value">0</div>
                    <div class="desc">可推荐用户数</div>
                </div>
                <div class="recomm-rule-submit">
                    <button class="vkbutton vbtn-pure vbtn-primary rule-finish">所有推荐规则设置完成</button>
                </div>
            </div>
        </div>
    </div>

    <!---------- 各种模板 ---------->
    <div id="tpl" style="display:none">
        <div class="item-setting">
            <div class="type-change"><a>切换为多选题</a></div>
            <div class="opt-custom dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown">自定义选项设置</a>
                <div class="dropdown-menu pull-right" role="menu" aria-labelledby="dLabel">
                    <div class="dropdown-wrap">
                        <div class="dw-left"></div>
                        <div class="dw-right"></div>
                    </div>
                    <div class="dropdown-body">
                        <div class="oc-elem none" data-user="999"><a>不允许任何用户自定义选项</a></div>
                        <div class="oc-elem all" data-user="-1"><a>允许所有用户自定义选项</a></div>
                        <div class="oc-elem some" data-user="">
                            <a>允许<span>部分</span>用户自定义选项</a>
                            <div class="custom-user-lvl">
                                <div class="cl-title">设定用户等级</div>
                                <select type="select" class="cl-select">
                                    <volist name="level" id="lvl">
                                        <option value="{$lvl.user_level_value}">{$lvl.user_level_desc}</option>
                                    </volist>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="add-option">
            <div class="vk-input green" contenteditable="true"></div>
            <div class="add-option-button">
                <button type="button" class="vkbutton vbtn-border vbtn-default" data-type="submit">确定</button>
                <button type="button" class="vkbutton vbtn-border vbtn-default" data-type="cancel">取消</button>
            </div>
        </div>
    </div>
</body>
</html>